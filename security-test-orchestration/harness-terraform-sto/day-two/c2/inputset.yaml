inputSet:
  name: ${inputset_identifier}
  tags: {}
  identifier: ${inputset_identifier}
  orgIdentifier: ${org_identifier}
  projectIdentifier: ${project_identifier}
  pipeline:
    identifier: ${pipeline_identifier}
    properties:
      ci:
        codebase:
          repoName: my-web-app-${project_identifier}
          build:
            type: branch
            spec:
              branch: main
    stages:
      - stage:
          identifier: Static_Tests
          type: SecurityTests
          spec:
            execution:
              steps:
                - stepGroup:
                    identifier: Flawfinder
                    steps:
                      - step:
                          identifier: RunFlawfinder
                          type: Run
                          spec:
                            connectorRef: mycontainerregistryconnector
                            image: ${container_registry_link}/library/flawfinder:0.0.1
                      - step:
                          identifier: FlawfinderIngest
                          type: CustomIngest
                          spec:
                            target:
                              type: repository
                              name: my-web-app-${project_identifier}
                              variant: main
                            advanced:
                              log:
                                level: info
                            ingestion:
                              file: <+pipeline.variables.sharedpath>/<+pipeline.variables.scanreport>
    variables:
      - name: scanreport
        type: String
        value: flawfinder.sarif
      - name: sharedpath
        type: String
        value: /shared/scan_results
